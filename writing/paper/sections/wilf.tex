Wilf-equivalence is an important aspect to study in the field of permutation
patterns.

\begin{definition}{(Wilf Equivalence.)}
  Two patterns \(\pi\) and \(\sigma\) are said to be \emph{Wilf-equivalent}
  if for all \(k\ge0, \size{\av[k]{\pi}} = \size{\av[k]{\sigma}}\). Two sets of
  permutation patterns \(R\) and \(S\) are \emph{Wilf-equivalent} if for all
  \(k\ge0, \size{\av[k]{R}} = \size{\av[k]{S}}\).
\end{definition}

Coincident patterns are trivially Wilf-equivalent: if \(\av[k]{R} = \av[k]{S}\)
then trivially \(\size{\av[k]{R}} = \size{\av[k]{S}}\). Coincidence is
therefore a stronger equivalence condition than Wilf-equivalence.

When examining Wilf-equivalences we can use a number of symmetries to reduce
the amount of work required. It can be seen that the reverse, complement
and inverse operations (see \FigureRef{fig:symm}) preserve enumeration, and
therefore classes related by these symmetries are trivially
Wilf-equivalent.
\begin{figure}[!htb]
\begin{align*}
    \rev{\textpattern{}{2,3,1}{}} &= \textpattern{}{1,3,2}{}\\
    \com{\textpattern{}{2,3,1}{}} &= \textpattern{}{2,1,3}{}\\
    \inv{\textpattern{}{2,3,1}{}} &= \textpattern{}{3,1,2}{}
\end{align*}
\caption{The operations reverse, complement and inverse for the pattern 231}
\label{fig:symm}
\end{figure}

Since we are always considering Wilf-equivalences in a set \(\av{S}\) we
must only use these symmetries when they preserve the dominating pattern, if we
were to allow other symmetries, then the equivalences calculated in the
previous section do not necessarily hold.

Throughout this section we will consider Wilf-equivalences of patterns
whilst avoiding the \emph{dominating pattern} \(\perm{2,3,1}\). We will
use \(\mathcal{C}\) to denote \(\av{\perm{2,3,1}}\) and \(C(x)\) will
be the usual Catalan generating function satisfying \(C(x) = 1 + xC(x)^2\).
The fact that \(C(x)\) is the generating function for \(\mathcal{C}\)
can be seen by structural decomposition around the maximum, as
shown in \FigureRef{fig:decompmax}.

\begin{figure}[!ht]
    \centering
    \decompmax{0/1,1/0}{A}{}{}{B}
    \caption{Structural decomposition of a non-empty avoider of 231}
    \label{fig:decompmax}
\end{figure}

The elements to the left of the maximum, \(A\), have the structure of a \(231\)
avoiding permutation, and the elements to the right of the maximum, \(B\), have
the structure of a \(\perm{2,3,1}\) avoiding permutation. Furthermore, all the
elements in \(A\) lie below all of the elements in \(B\). We call \(A\) the
\emph{lower-left section} and \(B\) the \emph{upper-right section}.

We can also decompose a permutation avoiding \(\perm{2,3,1}\) around the
leftmostpoint, giving a similar figure.

\subsection{Wilf-classes with mesh patterns of length 1.}
When considering the mesh patterns of length \(2\) it will be useful to know
the Wilf-equivalence classes of the mesh patterns of length \(1\) inside
\(\av{\perm{2,3,1}}\), this means that we are considering the set
\(\av{231,p}\)
where \(p\) is a mesh-pattern of length 1.

The patterns in the following set are coincident,
\begin{equation*}
    \left\{
        \begin{array}{c}
        \textpattern{}{1}{},
        \textpattern{}{1}{0/0},
        \textpattern{}{1}{1/0},
        \textpattern{}{1}{0/0,1/0},
        \textpattern{}{1}{0/1},\\
        \textpattern{}{1}{0/0,0/1},
        \textpattern{}{1}{1/1},
        \textpattern{}{1}{1/0,1/1},
        \textpattern{}{1}{0/1,1/1}
    \end{array}
    \right\}
\end{equation*}
due to the fact that every permutation, except the empty
permutation, must contain an occurrence of all of these patterns.

The pattern \(\textpattern{}{1}{0/0,1/0,0/1,1/1}\) is in its own
Wilf-class since the only permutation containing this pattern is
the permutation \(\perm{1}\). The avoiders of this pattern therefore
have generating function \(\var(x) = C(x)-x\).

\nextvar
The pattern \(p = \textpattern{}{1}{0/1,1/0}\) is one of the
quadrant marked mesh patterns studied by \textcite{2012arXiv1201.6243K}.
Alternatively we can enumerate
avoiders of \(p\) by decomposing a non-empty avoider of \(p\) around the
maximum element
in order to give the following structural decomposition.

\begin{equation*}
    \scriptvar = \varepsilon \sqcup
\decompmax{0/1,1/0}{\scriptvar}{}{}{\mathcal{C}\setminus\varepsilon}
\end{equation*}
If the upper-right section was empty the maximum would create an
occurrence of the pattern, however no points in this section can create
an occurrence since the maximum lies in a region corresponding to the
shading in \(p\), so we can use any avoider of \(\perm{2,3,1}\). The lower-left
section however can create occurrences
of \(p\) and therefore must also avoid \(p\), as well as \(\perm{2,3,1}\).
This gives the generating function of avoiders to be the function \(\var(x)\)
satisfying
\begin{align*}
    \var(x) &= 1 + x\var(x)(C(x)-1) \\
    \shortintertext{Solving for \(\var\) gives}
    \var(x) &= \frac{1}{1+x-xC(x)}\\
    \var(x) &= \frac{C(x)}{1+xC(x)}
\end{align*} % TODO Do we need both representations?

\noindent
Calculating coefficients given by this generating function gives the Fine
numbers.
\begin{equation*}
    1, 0, 1, 2, 6, 18, 57, 186, 622, 2120, 7338,\dotsc
\tag{\href{https://oeis.org/A000957}{OEIS: A000957}}
\end{equation*}

\nextvar[\varfine]
It can be shown by use of \PropositionRef{prop:dom2} that the patterns
\textpattern{}{1}{0/0,1/1} and \(q_1 = \textpattern{}{1}{0/0,0/1,1/1}\) are
coincident. Consider the decomposition of a non-empty avoider of \(q_1\) in
\(\av{\perm{2,3,1}}\) around the maximum:
\begin{equation*}
    \scriptvar_1 =\varepsilon \sqcup
\decompmax{0/1,1/0}{\mathcal{C}\setminus\varepsilon}{}{}{\mathcal{C}}
\end{equation*}
This can be explained succinctly by the fact that a permutation containing
\(q_1\) starts with its maximum, and by not allowing the lower-left section of the
\(\perm{2,3,1}\) avoider to be empty we prevent an occurrence from ever
happening.

Consider \(q_2 = \textpattern{}{1}{0/1,1/0,1/1}\). Avoiding this pattern
means that a permutation does not end with its maximum. We can perform a
similar
decomposition as before to get
\begin{equation*}
    \mathcal{\var}_2 =\varepsilon \sqcup
\decompmax{0/1,1/0}{\mathcal{C}}{}{}{\mathcal{C}\setminus\varepsilon}
\end{equation*}

% TODO Isn't q_3 a symmetry of q_2? So we don't need to repeat the work
Now consider \(q_3 = \textpattern{}{1}{0/0,0/1,1/0}\). The avoiders of this
pattern are permutations that do not start with their minimum. In this case we
perform the decomposition around the leftmost element
\begin{equation*}
    \mathcal{\var}_3 =\varepsilon \sqcup
\decompleft{0/1,1/0}{\mathcal{C}\setminus\varepsilon}{}{}{\mathcal{C}}
\end{equation*}
All of these classes have the same generating function, namely
\begin{equation}
    \var(x) = 1 + xC(x)(C(x)-1). \label{eqn:maxlgen}
\end{equation}
The coefficients of this generating function are
\begin{equation*}
    1, 0, 1, 3, 9, 28, 90, 297, 1001, 3432, 11934,\dotsc
\tag{\href{https://oeis.org/A000245}{OEIS: A000245} with offset \(1\)}
\end{equation*}

\nextvar[\varmaxl]
There is one pattern of length \(1\) still to consider. The pattern
\(r = \textpattern{}{1}{0/0,1/0,1/1}\) is avoided by all permutations
that do not end in their minimum. Any avoider of \(\perm{2,3,1}\) that
ends in its minimum must be a decreasing sequence.
Therefore this particular class has equation
\begin{equation*}
    \var(0) = 1, \var(x) = C(x)-1
\end{equation*}
Computing these values gives
\begin{equation*}
    	1, 0, 1, 4, 13, 41, 131, 428, 1429, 4861, 16795,\dotsc
\tag{\href{https://oeis.org/A141364}{OEIS: A141364}}
\end{equation*}

\section{Wilf-classes with patterns of length 2}
By the use of coincidence classes established in
\SectionRef{sec:coincs} we know that there are at most 95 Wilf-equivalence classes.

The only symmetry that we are able to consider is \emph{reverse-complement-inverse} as this is the only symmetry that preserves the
\(\perm{2,3,1}\) pattern. Using this symmetry we can find 61 classes of trivial
Wilf-equivalence, these equivalences being explained by either the patterns being
coincident in \(\av{\perm{2,3,1}}\), or by one pattern being the reverse-complement-inverse of some other pattern.

Computing avoiders up to length 10 suggests that there are at least 23 Wilf-classes,
of which 13 are non-trivial. Therefore there are Wilf-equivalences that are not
explained by coincidences or symmetry.

When considering the Wilf-equivalences we consider how permutations correspond
to set-partitions.

\begin{definition} A \emph{set partition} of \(\nrange{n}\) is a set of non-empty subsets of \(\nrange{n}\)
such that \(\nrange{n}\) is a \emph{disjoint} union of these subsets.
\end{definition}

\begin{note}
  The avoiders of the pattern \(q = \mperm{\perm{2,3,1}}{(1,0),(1,1),(1,2),(1,3)},
\textpattern{}{2,3,1}{1/0,1/1,1/2,1/3}\) in \(\mathfrak{S}_n\) are in one-to-one correspondence with partitions
of \(\nrange{n}\) (\textcite[Prop.~2]{DBLP:journals/ejc/Claesson01})
\end{note}
\begin{example}
    The permutation \(\pi = \perm{5,4,2,1,3,9,6,8,7}\) corresponds to the
    partition \(\{\{5,4,2,1\},\{3\},\{9,6\},\{8,7\}\}\).
\end{example}

We will call the least element in each block the \emph{block-bottom}, and note that all permutations
in \(\av{\perm{2,3,1}}\) also avoid the mesh pattern \(q\).

We will use two main methods of establishing Wilf-equivalence between mesh patterns of length \(2\)
in \(\av{\perm{2,3,1}}\): the structural decomposition of avoiders, via generating functions; or the
structure of the set-partition induced by the pattern, looking at a particular occurrence of the
pattern in a permutation avoiding \(\perm{2,3,1}\). Sometimes it will be necessary to use both of
these methods to consolidate a single Wilf-class.

\subsection{}
\nextvar
The following patterns are experimentally Wilf-equivalent up to length 10 in
\(\av{\perm{2,3,1}}\)
\begin{gather}
    m_1 = \pattern{}{1,2}{0/0,0/1,1/1,1/2,2/0,2/1},
    m_2 = \pattern{}{2,1}{0/0,0/1,1/1,1/2,2/0,2/1}, \label{eq:singleud}\\
    m_3 = \pattern{}{2,1}{0/1,0/2,1/0,1/1,1/2,2/1}, \text{ and }
    m_4 = \pattern{}{2,1}{0/1,0/2,1/0,1/1,1/2,2/0} \label{eq:other}
\end{gather}

First we prove the Wilf-equivalence between \(m_1\) and \(m_2\) shown in
\eqref{eq:singleud}, by considering the containers as set partitions consider
the containers as set partitions.

Considering an occurrence of either of these patterns in a permutation  we know
the following about the points corresponding to the points in the patterns.
\begin{itemize}
    \item The point corresponding to the first point in both patterns
        must lie in the first block of the set partition (there are
        no points southwest from it in the permutation).
    \item The point corresponding to the second point in both patterns
        is a block bottom (there are no points southeast of it in
        the permutation).
    \item If the region corresponding to box \((2,2)\) in an occurrence of
    \(m_1\) is empty, then the point corresponding to the second point is
    precisely the last block bottom. If the region corresponding to box \((0,1)\)
    in an occurrence of \(m_2\) is empty, then the point corresponding to the
    second point is precisely the first block bottom.
    If these regions are non-empty then the block containing the point
    corresponding to the second point in both patterns contains only the point
    (it is a singleton block).
\end{itemize}
This tells us that an occurrence of the patterns must happen when there
is a singleton block occurring after the first block. The difference
between the patterns is in the underlying classical pattern. This
means that permutations containing \(m_1\) correspond to set partitions
with a singleton block with value one higher than some element in the
block containing \(1\). The permutations containing \(m_2\) correspond
to the set partitions containing a block with block bottom having value
one lower than some element in the block containing \(1\) and if this
block is not the block containing \(1\) then it is a singleton block. This
proves that the containers of both of these patterns in \(\av{231}\) are
equinumerous, and therefore so are their avoiders.

Consider an avoider of \(\perm{2,3,1}\) and \(m_3\). We can perform
the decomposition around the maximum
\begin{equation*}
    \scriptvar_1 = \varepsilon \sqcup
    \decompmax{1/0,0/1}{\scriptvar_1}{}{}{\mathcal{\varmaxl}_1}
\end{equation*}
Only the first point in the top right region can
create an occurrence of \(m_3\) if and only if it is the
element with largest value in this region, therefore the partial permutation
in this region must avoid starting with the maximum.

Looking at avoiders of \(\perm{2,3,1}\) and \(m_4\) we
can perform a similar decomposition around the maximum to get
\begin{equation*}
    \scriptvar_2 = \varepsilon \sqcup
    \decompmax{1/0,0/1}{\scriptvar_2}{}{}{\mathcal{\varmaxl}_3}
\end{equation*}
An occurrence of \(m_4\) can never occur in the
top right region. It could only occur between the maximum and the first point
in the region, if and only if this first point is the lowest valued element in
this region.
Since both \(\mathcal{\varmaxl}_1\) and \(\mathcal{\varmaxl}_3\) have the same
enumeration, \(\scriptvar_1\) and \(\scriptvar_2\) must also have
the same enumeration and are therefore Wilf-equivalent.

Now we must consolidate these two subclasses. In order to do this we must
consider the decomposition around the leftmost point of a permutation in
\(\av{\perm{2,3,1},m_1}\). We have the following
\begin{equation*}
    \scriptvar_3 = \varepsilon \sqcup
    \decompleft{1/0,0/1}{\scriptvar_3}{}{}{\mathcal{\varmaxl}_3}
\end{equation*}
It is therefore obvious that avoiders of \(m_1\) and avoiders of \(m_4\)
have the same enumeration, and therefore all four patterns are Wilf-equivalent
in \(\av{\perm{2,3,1}}\) with generating function satisfying
\begin{equation*}
    \var(x) = 1 + x\var(x)\varmaxl(x)
\end{equation*}
where \(\varmaxl(x)\) is the generating function given in \EquationRef{eqn:maxlgen}.
This can be enumerated to give the sequence
\begin{equation*}
    1, 1, 1, 2, 6, 19, 61, 200, 670, 2286, 7918,\dotsc \tag{\href{https://oeis.org/A035929}{OEIS: A035929} offset 1}
\end{equation*}

This particular example is interesting as it shows that both methods can be used in tandem to establish a coincidence class.

\subsection{}
\nextvar
The following patterns are experimentally Wilf-equivalent up to length 10 in
\(\av{\perm{2,3,1}}\)
\begin{equation*}
    m_1 = \pattern{}{1,2}{1/0,1/1,1/2,2/0,2/1} \text{ and }
    m_2 = \pattern{}{2,1}{0/1,1/0,1/1,1/2,2/1}
\end{equation*}
Let \(\scriptvar_1\) be the set of avoiders of \(m_1\) in \(\av{231}\). By structural decomposition
around the leftmost point we have
\begin{equation*}
    \scriptvar_1 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptvar_1}{}{}{\scriptvar^\prime_1}
\end{equation*}

\noindent
Here \(\scriptvar^\prime_1\) is a permutation avoiding \(\perm{2,3,1}, m_1\)
and \(\textpattern{}{1}{0/0,0/1,1/0}\).
Now consider the decomposition of a permutation in \(\scriptvar^\prime_1\). It can
once again be decomposed around the leftmost point
\begin{equation*}
    \scriptvar^\prime_1 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptstyle \scriptvar_1\setminus\varepsilon}{}{}{\scriptvar^\prime_1}
\end{equation*}
This is a complete decomposition of avoiders of \(m_1\). Now we
look at an avoider of \(m_2\), this time decomposition is around the leftmost point
\begin{equation*}
    \scriptvar_2 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptvar^\prime_2}{}{}{\scriptvar_2}
\end{equation*}

Where \(\scriptvar^\prime_2\) is a permutation avoiding \(\perm{2,3,1}, m_2\)
and \(\textpattern{}{1}{0/0,0/1,1/1}\).
Again we use the same method of decomposition of a permutation in \(\scriptvar^\prime_2\)
\begin{equation*}
    \scriptvar^\prime_2 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptvar^\prime_2}{}{}{\scriptstyle \scriptvar_2\setminus\varepsilon}
\end{equation*}
This gives us a generating function \(\var(x)\) satisfying
\begin{align}
    \var(x) &= 1 + x\var(x)\var^\prime(x) \label{eqn:Pgen}\\
    \var^\prime(x) &= 1 + x(\var(x)-1)\var^\prime(x)\label{eqn:PprimeGen}
\end{align}
Solving \EquationRef{eqn:PprimeGen} for \(\var^\prime(x)\) and substituting into
\EquationRef{eqn:Pgen} gives us that the generating function for
\(\var(x)\) satisfies
\begin{equation}
    \var(x) = x\var^2(x) - x(\var(x) - 1) + 1
\end{equation}
Evaluating \(\var(x)\) gives us the sequence
\begin{equation*}
    1, 1, 1, 2, 4, 9, 21, 51, 127, 323, 835,\dotsc \tag{\href{https://oeis.org/A001006}{OEIS: A001006 with offset 1}}
\end{equation*}
Which is an offset of the Motzkin numbers.

In order to establish the remainder of the Wilf-equivalences of the form \(\av{231,p}\) where \(p\)
is a mesh pattern we can use similar methods to allow us to consolidate experimental classes into
actual classes, these methods allow us to explain all 23 of the observed Wilf-classes seen in experimentation.
