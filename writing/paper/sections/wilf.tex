Wilf-equivalence is an important aspect to study in the field of permutation
patterns. The original definition is as follows:

\begin{definition}
  Two patterns \(\pi\) and \(\sigma\) are said to be \emph{Wilf-equivalent}
  if for all \(k\ge0, \size{\av[k]{\pi}} = \size{\av[k]{\sigma}}\). Two sets of
  permutation patterns \(R\) and \(S\) are \emph{Wilf-equivalent} if for all
  \(k\ge0, \size{\av[k]{R}} = \size{\av[k]{S}}\).
\end{definition}

Coincident patterns are trivially Wilf-equivalent: if \(\av[k]{R} = \av[k]{S}\)
then trivially \(\size{\av[k]{R}} = \size{\av[k]{S}}\). Coincidence is
therefore a stronger equivalence condition than Wilf-equivalence.

When examining Wilf-equivalences we can use a number of symmetries to reduce the
amount of work required. It can be seen that the reverse, complement and inverse
operations (see \FigureRef{fig:symm}) preserve enumeration, and therefore
classes related by these symmetries are trivially Wilf-equivalent.
\begin{figure}[!htb]
\begin{align*}
    \rev{\textpattern{}{2,3,1}{}} &= \textpattern{}{1,3,2}{}\\
    \com{\textpattern{}{2,3,1}{}} &= \textpattern{}{2,1,3}{}\\
    \inv{\textpattern{}{2,3,1}{}} &= \textpattern{}{3,1,2}{}
\end{align*}
\caption{The operations reverse, complement and inverse for the pattern 231}
\label{fig:symm}
\end{figure}

Since we will consider Wilf-equivalences in a set \(\av{S}\) we
must only use symmetries that preserve the dominating pattern(s) in \(S\), if we
were to allow other symmetries, then the equivalences calculated in the
previous section do not necessarily hold.

In the remainder of the paper we will consider Wilf-equivalences of patterns
whilst avoiding the \emph{dominating pattern} \(\perm{2,3,1}\), if two patterns
\(p_1 \et p_2\) are Wilf-equivalent we will denote this \(p_1\weqv{231}p_2\),
similarly when computational methods indicate that two patterns are Wilf
equivalent under \(231\) we write \(p_1\weqv[comp]{231}p_2\). We will use
\(\mathcal{C}\) to denote \(\av{\perm{2,3,1}}\) and \(C(x)\) will be the usual
Catalan generating function satisfying \(C(x) = 1 + xC(x)^2\). The fact that
\(C(x)\) is the generating function for \(\mathcal{C}\) can be seen by
structural decomposition around the maximum, as
shown in \FigureRef{fig:decompmax}.

\begin{figure}[!ht]
    \centering
    \decompmax{0/1,1/0}{A}{}{}{B}
    \caption{Structural decomposition of a non-empty avoider of 231}
    \label{fig:decompmax}
\end{figure}

The elements to the left of the maximum, \(A\), have the structure of a \(231\)
avoiding permutation, and the elements to the right of the maximum, \(B\), also have
the structure of a \(\perm{2,3,1}\) avoiding permutation. Furthermore, all the
elements in \(A\) lie below all of the elements in \(B\). We call \(A\) the
\emph{lower-left section} and \(B\) the \emph{upper-right section}.

We can also decompose a permutation avoiding \(\perm{2,3,1}\) around the
leftmost point, giving a similar figure.

\subsection{Wilf-classes with mesh patterns of length 1.}
\label{wilf1}
When considering the mesh patterns of length \(2\) it will be useful to know the
Wilf-equivalence classes of the mesh patterns of length \(1\) inside
\(\av{\perm{2,3,1}}\), this means that we are considering the
\(\weqv{231}\)-equivalence classes of mesh patterns with underlying classical
pattern \(1\).

The patterns in the following set are coincident,
\begin{equation*}
    \left\{
        \begin{array}{c}
        \textpattern{}{1}{},
        \textpattern{}{1}{0/0},
        \textpattern{}{1}{1/0},
        \textpattern{}{1}{0/0,1/0},
        \textpattern{}{1}{0/1},\\
        \textpattern{}{1}{0/0,0/1},
        \textpattern{}{1}{1/1},
        \textpattern{}{1}{1/0,1/1},
        \textpattern{}{1}{0/1,1/1}
    \end{array}
    \right\}
\end{equation*}
due to the fact that every permutation, except the empty
permutation, must contain an occurrence of all of these patterns.

The pattern \(\textpattern{}{1}{0/0,1/0,0/1,1/1}\) is in its own
\(\weqv{231}\)-equivalence class since the only permutation containing it is
the permutation \(\perm{1}\). The avoiders of this pattern therefore
have generating function \(\var(x) = C(x)-x\).

\nextvar
The pattern \(p = \textpattern{}{1}{0/1,1/0}\) is one of the
quadrant marked mesh patterns studied by \textcite{2012arXiv1201.6243K}.
Alternatively we can enumerate
avoiders of \(p\) by decomposing a non-empty avoider of \(p\) around the
maximum element
in order to give the following structural decomposition.

\begin{equation*}
    \scriptvar = \varepsilon \sqcup
\decompmax{0/1,1/0}{\scriptvar}{}{}{\mathcal{C}\setminus\varepsilon}
\end{equation*}
If the upper-right section was empty the maximum would create an
occurrence of the pattern, however no points in this section can create
an occurrence since the maximum lies in a region corresponding to the
shading in \(p\), so we can use any avoider of \(\perm{2,3,1}\). The lower-left
section however can create occurrences
of \(p\) and therefore must also avoid \(p\), as well as \(\perm{2,3,1}\).
This gives the generating function of avoiders to be the function \(\var(x)\)
satisfying
\begin{align*}
    \var(x) &= 1 + x\var(x)(C(x)-1) \\
    \shortintertext{Solving for \(\var\) gives}
    \var(x) &= \frac{1}{1-x(C(x)-1)}
\end{align*}

\noindent
Calculating coefficients given by this generating function gives the Fine
numbers.
\begin{equation*}
    1, 0, 1, 2, 6, 18, 57, 186, 622, 2120, 7338,\dotsc
\tag{\href{https://oeis.org/A000957}{OEIS: A000957}}
\end{equation*}

\nextvar[\varfine]
It can be shown by use of the Second Dominating Pattern Rule that the patterns
\textpattern{}{1}{0/0,1/1} and \(q_1 = \textpattern{}{1}{0/0,0/1,1/1}\) are
coincident under \(\perm{2,3,1}\). Consider the decomposition of a non-empty
avoider of \(q_1\) in \(\av{\perm{2,3,1}}\) around the maximum:
\begin{equation*}
    \scriptvar_1 =\varepsilon \sqcup
\decompmax{0/1,1/0}{\mathcal{C}\setminus\varepsilon}{}{}{\mathcal{C}}
\end{equation*}
This can be explained succinctly by the fact that a permutation containing
\(q_1\) starts with its maximum, and by not allowing the lower-left section of the
\(\perm{2,3,1}\) avoider to be empty we prevent an occurrence from ever
happening.

Consider \(q_2 = \textpattern{}{1}{0/1,1/0,1/1}\). Avoiding this pattern
means that a permutation does not end with its maximum. We can perform a
similar
decomposition as before to get
\begin{equation*}
    \mathcal{\var}_2 =\varepsilon \sqcup
\decompmax{0/1,1/0}{\mathcal{C}}{}{}{\mathcal{C}\setminus\varepsilon}
\end{equation*}
The pattern \(q_3 = \textpattern{}{1}{0/0,0/1,1/0}\) is the
reverse-complement-inverse of \(q_2\) and hence the avoiders of \(q_2\) and
\(q_3\) (\(\scriptvar_2\) and \(\scriptvar_3\)) are equinumerous, and so \(q_1
\weqv{231} q_2 \weqv{231}q_3\). All of these classes have the same generating
function, namely
\begin{equation}
    \var(x) = 1 + xC(x)(C(x)-1). \label{eqn:maxlgen}
\end{equation}
The coefficients of this generating function are
\begin{equation*}
    1, 0, 1, 3, 9, 28, 90, 297, 1001, 3432, 11934,\dotsc
\tag{\href{https://oeis.org/A000245}{OEIS: A000245} with offset \(1\)}
\end{equation*}

\nextvar[\varmaxl]
There is one pattern of length \(1\) still to consider. The pattern
\(r = \textpattern{}{1}{0/0,1/0,1/1}\) is avoided by all permutations
that do not end in their minimum. Any avoider of \(\perm{2,3,1}\) that
ends in its minimum must be a decreasing sequence.
Therefore this particular class has equation
\begin{equation*}
    \var(0) = 1, \var(x) = C(x)-1
\end{equation*}
Computing these values gives
\begin{equation*}
    	1, 0, 1, 4, 13, 41, 131, 428, 1429, 4861, 16795,\dotsc
\tag{\href{https://oeis.org/A141364}{OEIS: A141364}}
\end{equation*}

\section{Wilf-classes with patterns of length 2}
From \SectionRef{sec:coincs} we know there are \(95\) coincidence classes and
therefore at most that many Wilf-equivalence classes.

The only symmetry that we are able to consider is
\emph{reverse-complement-inverse} as this is the only symmetry that preserves
the \(\perm{2,3,1}\) pattern. Using this symmetry we can find 61 classes of
trivial Wilf-equivalence, these equivalences being explained by either the
patterns being coincident in \(\av{\perm{2,3,1}}\), or by one pattern being the
reverse-complement-inverse of some other pattern.

Computing avoiders up to length 10 gives 23 \(\weqv[comp]{231}\)-equivalence
classes, of which 13 are not equal to coincidence classes (after taking
symmetries). Therefore there seem to be Wilf-equivalences that are not explained
by coincidences or symmetry.

We will use two main methods of establishing these Wilf-equivalences: the
structural decomposition of avoiders, via generating functions; or the structure
of a general permutation containing the pattern, looking at a particular
occurrence of the pattern in a permutation avoiding \(\perm{2,3,1}\). Sometimes
it will be necessary to use both of these methods to consolidate a single
Wilf-class.

\subsection{}
\nextvar
The following patterns are in the same \(\weqv[comp]{231}\)-equivalence class
\begin{gather}
    m_1 = \pattern{}{1,2}{0/0,0/1,1/1,1/2,2/0,2/1},
    m_2 = \pattern{}{2,1}{0/0,0/1,1/1,1/2,2/0,2/1}, \label{eq:singleud}\\
    m_3 = \pattern{}{2,1}{0/1,0/2,1/0,1/1,1/2,2/1}, \text{ and }
    m_4 = \pattern{}{2,1}{0/1,0/2,1/0,1/1,1/2,2/0} \label{eq:other}
\end{gather}

First we prove that \(m_1 \weqv{231} m_2\) by considering the form of a general permutation containing
either of the two patterns. First looking at a general occurrence of \(m_1\) in a permutation
in \(\av{231}\)
\begin{equation*}
\begin{tikzpicture}[scale=1.0]
\modpattern[4]{}{1,2}{0/0,0/1,1/1,1/2,2/0,2/1}
\node at (0.5,2.5) {\Large \(A\)};
\node at (2.5,2.5) {\Large \(B\)};
\node at (1.5,0.5) {\Large \(C\)};
\end{tikzpicture}
\end{equation*}

If there is an occurrence of \(m_1\) there must be a lowest occurrence of
\(m_1\), \ie, the occurrence has the lowest possible values for any occurrence.
Now consider the top regions, labelled \(A \et B\), the subpermutation contained
in the union of these regions must avoid the permutation \(231\). Also, the
subpermutation in the region \(A\) must be a decreasing subsequence, otherwise
an occurrence of \(231\) will be created with either of the points in the
occurrence of \(m_1\). Now, consider the region labelled \(C\), since we
specified that we were focused on the lowest possible occurrence of \(m_1\) this
region cannot contain an occurrence of either \(m_1\) or \(231\). This is a full
structural decomposition of a container of \(m_1\) inside \(\av{231}\).

Now consider a general occurrence of \(m_2\) in a permutation
in \(\av{231}\)
\begin{equation*}
\begin{tikzpicture}[scale=1.0]
\modpattern[4]{}{2,1}{0/0,0/1,1/1,1/2,2/0,2/1}
\node at (0.5,2.5) {\Large \(A^\prime\)};
\node at (2.5,2.5) {\Large \(B^\prime\)};
\node at (1.5,0.5) {\Large \(C^\prime\)};
\end{tikzpicture}
\end{equation*}

Similarly to a container of \(m_1\) we will look at the lowest possible
occurrence of \(m_2\), and as before the regions \(A^\prime \et B^\prime\)
together contain an avoider of \(231\) and \(A\) contains a decreasing
subsequence. Since we are considering the lowest occurrence of \(m_2\) the
region \(C^\prime\) does not contain an occurrence of either \(m_2\) or \(231\).

Since all the regions in both of these cases contain the same parts,  the
classes defined by containment of \(m_1\) and \(m_2\) inside
\(\av{\perm{2,3,1}}\) are equinumerous and therefore so are their avoiders.

Consider the class, \(\scriptvar_3\), of permutations defined by avoiding
\(\perm{2,3,1}\) and \(m_3\). We can decompose a member of this class around the
maximum
\begin{equation*}
    \scriptvar_3 = \varepsilon \sqcup
    \decompmax{1/0,0/1}{\scriptvar_3}{}{}{\mathcal{\varmaxl}_1}
\end{equation*}
Only the first point in the top right region can create an occurrence of \(m_3\)
if and only if it is the element with largest value in this region, therefore
the partial permutation in this region must avoid starting with the maximum,
\ie, be in \(\mathcal{\varmaxl}_1 = \av{\textpattern{}{1}{0/0,0/1,1/1}}\)
described
in \SectionRef{wilf1}.

Looking at avoiders of \(\perm{2,3,1}\) and \(m_4\) we
can perform a similar decomposition around the maximum to get
\begin{equation*}
    \scriptvar_4 = \varepsilon \sqcup
    \decompmax{1/0,0/1}{\scriptvar_4}{}{}{\mathcal{\varmaxl}_3}
\end{equation*}
An occurrence of \(m_4\) can never occur in the
top right region. It could only occur between the maximum and the first point
in the region, if and only if this first point is the lowest valued element in
this region, so this top right region must contain a sub-permutation that does not
start with it's minimum, i.e., it is a member of \(\mathcal{\varmaxl}_3 = \av{\av{\textpattern{}{1}{0/0,0/1,1/0}}}\).
Since both \(\mathcal{\varmaxl}_1\) and \(\mathcal{\varmaxl}_3\) have the same
enumeration, \(\scriptvar_3\) and \(\scriptvar_4\) must also have
the same enumeration and are therefore \(m_3\weqv{231}m_4\).

Now we must consolidate these two subclasses. In order to do this we must
consider the decomposition around the leftmost point of a permutation in
\(\av{\{\perm{2,3,1},m_1\}}\). We have the following
\begin{equation*}
    \scriptvar_1 = \varepsilon \sqcup
    \decompleft{1/0,0/1}{\scriptvar_1}{}{}{\mathcal{\varmaxl}_3}
\end{equation*}
It is therefore clear that avoiders of \(m_1\) and avoiders of \(m_4\) have the
same enumeration, and therefore \(m_1 \weqv{231} m_2 \weqv{231}m_3\weqv{m_4}\)
with generating function satisfying
\begin{equation*}
    \var(x) = 1 + x\var(x)\varmaxl(x)
\end{equation*}
where \(\varmaxl(x)\) is the generating function given in \EquationRef{eqn:maxlgen}.
This can be enumerated to give the sequence
\begin{equation*}
    1, 1, 1, 2, 6, 19, 61, 200, 670, 2286, 7918,\dotsc \tag{\href{https://oeis.org/A035929}{OEIS: A035929} offset 1}
\end{equation*}

\subsection{}
\nextvar
The patterns \(m_1 \et m_2\) are in the same \(\weqv[comp]{231}\)-equivalence class
\begin{equation*}
    m_1 = \pattern{}{1,2}{1/0,1/1,1/2,2/0,2/1} \text{ and }
    m_2 = \pattern{}{2,1}{0/1,1/0,1/1,1/2,2/1}
\end{equation*}
Let \(\scriptvar_1\) be the set of avoiders of \(m_1\) in \(\av{231}\). By
structural decomposition around the leftmost point we have
\begin{equation*}
    \scriptvar_1 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptvar_1}{}{}{\scriptvar^\prime_1}
\end{equation*}

\noindent
Here \(\scriptvar^\prime_1\) is a permutation avoiding \(\perm{2,3,1}, m_1\) and
\(\textpattern{}{1}{0/0,0/1,1/0}\). Now consider the decomposition of a
permutation in \(\scriptvar^\prime_1\). It can once again be decomposed around
the leftmost point
\begin{equation*}
    \scriptvar^\prime_1 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptstyle \scriptvar_1\setminus\varepsilon}{}{}{\scriptvar^\prime_1}
\end{equation*}
This is a complete decomposition of avoiders of \(m_1\). Now we look at an
avoider of \(m_2\), decomposed around the leftmost point
\begin{equation*}
    \scriptvar_2 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptvar^\prime_2}{}{}{\scriptvar_2}
\end{equation*}

Where \(\scriptvar^\prime_2\) is a permutation avoiding \(\perm{2,3,1}, m_2\)
and \(\textpattern{}{1}{0/0,0/1,1/1}\). Again we use the same method of
decomposition of a permutation in \(\scriptvar^\prime_2\)
\begin{equation*}
    \scriptvar^\prime_2 = \varepsilon \sqcup
    \decompleft{0/1,1/0}{\scriptvar^\prime_2}{}{}{\scriptstyle \scriptvar_2\setminus\varepsilon}
\end{equation*}
This gives us a generating function \(\var(x)\) satisfying
\begin{align}
    \var(x) &= 1 + x\var(x)\var^\prime(x) \label{eqn:Pgen}\\
    \var^\prime(x) &= 1 + x(\var(x)-1)\var^\prime(x)\label{eqn:PprimeGen}
\end{align}
Solving \EquationRef{eqn:PprimeGen} for \(\var^\prime(x)\) and substituting into
\EquationRef{eqn:Pgen} gives us that the generating function for
\(\var(x)\) satisfies
\begin{equation}
    \var(x) = x\var^2(x) - x(\var(x) - 1) + 1
\end{equation}
Evaluating \(\var(x)\) gives us the sequence
\begin{equation*}
    1, 1, 1, 2, 4, 9, 21, 51, 127, 323, 835,\dotsc \tag{\href{https://oeis.org/A001006}{OEIS: A001006 with offset 1}}
\end{equation*}
Which is an offset of the Motzkin numbers.

In order to establish the remainder of the Wilf-equivalences of the form
\(\av{\{\perm{2,3,1},p\}}\) where \(p\) is a mesh pattern of length \(2\) we can
use similar methods to allow us to consolidate experimental classes into actual
classes, these methods allow us to explain all 23 of the observed Wilf-classes
seen in experimentation.
